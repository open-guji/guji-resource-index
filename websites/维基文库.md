# ç»´åŸºæ–‡åº“ (Wikisource)

<!--
  æœ¬æ–‡ä»¶åˆ†ä¸¤éƒ¨åˆ†ï¼š
  - åˆ†å‰²çº¿ä»¥ä¸Šï¼šç”¨æˆ·æ–‡æ¡£ï¼Œé¢å‘æ™®é€šç”¨æˆ·ï¼Œè¯­è¨€ç®€æ´æ˜“æ‡‚ï¼Œä¸å«æŠ€æœ¯ç»†èŠ‚
  - åˆ†å‰²çº¿ä»¥ä¸‹ï¼šå¼€å‘è€…æ–‡æ¡£ï¼Œé¢å‘ç¨‹åºå‘˜ï¼ŒåŒ…å« APIã€HTML è§£æã€ä¸‹è½½é€»è¾‘ç­‰æŠ€æœ¯ç»†èŠ‚
-->

ç»´åŸºæ–‡åº“æ˜¯ç»´åŸºåª’ä½“åŸºé‡‘ä¼šæ——ä¸‹çš„ä¸€ä¸ªè‡ªç”±å†…å®¹æ•°å­—å›¾ä¹¦é¦†ï¼Œæ—¨åœ¨æ”¶é›†å„ç§è¯­è¨€çš„å®Œæ•´åŸå§‹æ–‡çŒ®ï¼ˆå¦‚å¤ç±ã€æ³•å¾‹æ–‡æœ¬ã€å†å²æ¡£æ¡ˆç­‰ï¼‰ï¼Œå¹¶æä¾›å¤šäººåä½œçš„æ ¡å¯¹åŠŸèƒ½ã€‚ç›®å‰ä¸­æ–‡ç»´åŸºæ–‡åº“æ”¶å½•äº†å¤§é‡ç»å²å­é›†ã€æ°‘å›½æ–‡çŒ®ç­‰çè´µèµ„æºã€‚

- ç½‘ç«™é“¾æ¥ï¼šhttps://zh.wikisource.org/
- åˆ†äº«åè®®ï¼š[CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/deed.zh)ï¼ˆéƒ¨åˆ†å…¬æœ‰é¢†åŸŸå†…å®¹é™¤å¤–ï¼‰
- çº¦ 100ä¸‡+ ç¯‡/éƒ¨æ–‡çŒ®ï¼ˆåŒ…å«å•ç‹¬çš„è¯—è¯æ–‡ç« ï¼‰
- èµ„æºç±»å‹ï¼šå–„æœ¬æ‰«æä»¶ï¼ˆDjVu/PDFï¼‰ã€ç”µå­å…¨æ–‡ï¼ˆE-textï¼‰ã€å†å²æ¡£æ¡ˆ
- æ”¯æŒ IIIF åè®®ï¼ˆé€šè¿‡ Toolforge å·¥å…·ä»£ç†ï¼‰ï¼Œbookgetæš‚æœªç›´æ¥æ”¯æŒï¼Œä½†å¯é€šè¿‡ MediaWiki API ä¸‹è½½

## æœç´¢ä¸æµè§ˆ

- æœç´¢é¡µé¢ï¼šhttps://zh.wikisource.org/w/index.php?search=
- åœ¨æœç´¢æ¡†è¾“å…¥ä¹¦åæˆ–ä½œè€…å³å¯ã€‚æ”¯æŒé«˜çº§æœç´¢ï¼Œå¯é™å®šåå­—ç©ºé—´ï¼ˆå¦‚ä»…æœç´¢â€œIndex/ç´¢å¼•â€åå­—ç©ºé—´ä»¥æŸ¥æ‰¾æ‰«æçš„åŸä¹¦ï¼‰ã€‚
- æœç´¢ç»“æœé€šå¸¸æ··åˆäº†å•ç¯‡è¯—æ–‡ã€ç« èŠ‚å’Œæ•´ä¹¦ã€‚è‹¥è¦æ‰¾æ‰«æç‰ˆä¹¦ç±ï¼Œè¯·è®¤å‡† `Index:` æˆ– `ç´¢å¼•:` å¼€å¤´çš„æ¡ç›®ã€‚
- **æ— éœ€æ³¨å†Œç™»å½•**å³å¯æµè§ˆå’Œä¸‹è½½ï¼ˆéƒ¨åˆ†åŠŸèƒ½å¦‚ä¸Šä¼ ã€ç¼–è¾‘éœ€è¦ç™»å½•ï¼‰ã€‚

## æ¯æœ¬ä¹¦èƒ½çœ‹åˆ°ä»€ä¹ˆ

ä»¥æ‰«æç‰ˆä¹¦ç±ï¼ˆIndex/ç´¢å¼•é¡µï¼‰ä¸ºä¾‹ï¼š

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| æ ‡é¢˜ | ä¹¦å | æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€) |
| è‘—è€… | ä½œè€… | (æ¸…)å³å…¶æ¿¬ |
| ç‰ˆæœ¬ | ç‰ˆæœ¬ä¿¡æ¯ | æ°‘åœ‹8å¹´å•†å‹™å°æ›¸é¤¨ |
| å‡ºç‰ˆå¹´ | å‡ºç‰ˆå¹´ä»½ | 1919 |
| æ¥æº | æ¥æºè¯´æ˜ | ä¾†è‡ª åœ‹ç«‹ä¸­å¤®åœ–æ›¸é¤¨ |
| å›¾åƒ | æ‰«ææºæ–‡ä»¶ | æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu |
| è¿›åº¦ | æ ¡å¯¹è¿›åº¦ | ğŸŸ¢ (å·²æ ¡å¯¹) / ğŸ”´ (æœªæ ¡å¯¹) |

**ç‰¹è‰²åŠŸèƒ½**ï¼š
- **å›¾æ–‡å¯¹ç…§**ï¼šç‚¹å‡»é¡µç å¯è¿›å…¥â€œPage/é¡µâ€è§†å›¾ï¼Œå·¦ä¾§æ˜¾ç¤ºæ‰«æå›¾ï¼Œå³ä¾§æ˜¾ç¤ºOCR/æ ¡å¯¹åçš„æ–‡å­—ã€‚
- **å¤šç§å¯¼å‡º**ï¼šæ”¯æŒä¸‹è½½ä¸º PDFã€EPUBã€MOBI æ ¼å¼ï¼ˆåœ¨å·¦ä¾§æ â€œæ‰“å°/å¯¼å‡ºâ€ä¸­ï¼‰ã€‚
- **å®Œæ•´æ‰«æä»¶ä¸‹è½½**ï¼šç‚¹å‡»æºæ–‡ä»¶åï¼ˆå¦‚ xxx.djvuï¼‰å¯è·³è½¬åˆ°æ–‡ä»¶é¡µä¸‹è½½åŸå§‹ DjVu æˆ– PDF æ–‡ä»¶ã€‚

## ç¤ºä¾‹

- ç´¢å¼•é¡µï¼ˆä¹¦ç›®è¯¦æƒ…ï¼‰ï¼š[Index:æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu](https://zh.wikisource.org/wiki/Index:%E6%A4%8D%E7%89%A9%E5%90%8D%E5%AF%A6%E5%9C%96%E8%80%83(%E4%B8%80).djvu)
- é¡µé¢è§†å›¾ï¼ˆå›¾æ–‡å¯¹ç…§ï¼‰ï¼š[Page:æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu/10](https://zh.wikisource.org/wiki/Page:%E6%A4%8D%E7%89%A9%E5%90%8D%E5%AF%A6%E5%9C%96%E8%80%83(%E4%B8%80).djvu/10)
- ä½œå“ä¸»é¡µï¼ˆæ•´ç†åçš„å…¨æ–‡ï¼‰ï¼š[æ¤ç‰©åå¯¦åœ–è€ƒ](https://zh.wikisource.org/wiki/%E6%A4%8D%E7%89%A9%E5%90%8D%E5%AF%A6%E5%9C%96%E8%80%83)

---

# å¼€å‘è€…æ–‡æ¡£

## URL ç»“æ„

ç»´åŸºæ–‡åº“åŸºäº MediaWikiï¼ŒURL ç»“æ„éå¸¸æ ‡å‡†ï¼š

### 1. ç´¢å¼•é¡µ (Index Page) - åŒ…å«å…ƒæ•°æ®å’Œé¡µç åˆ—è¡¨
```
https://zh.wikisource.org/wiki/Index:{Filename}
```
- `{Filename}`: åŸå§‹æ‰«ææ–‡ä»¶çš„æ–‡ä»¶åï¼ˆé€šå¸¸æ˜¯ .djvu æˆ– .pdf ç»“å°¾ï¼‰ï¼Œå¦‚ `Index:æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu`ã€‚
- **ç”¨é€”**ï¼šè·å–ä¹¦ç±å…ƒæ•°æ®ã€é¡µç åˆ—è¡¨ã€æ ¡å¯¹çŠ¶æ€ã€‚

### 2. é¡µé¢è§†å›¾ (Page View) - å•é¡µå›¾æ–‡å¯¹ç…§
```
https://zh.wikisource.org/wiki/Page:{Filename}/{PageNumber}
```
- `{PageNumber}`: æ–‡ä»¶å†…éƒ¨çš„é¡µç ï¼ˆä» 1 å¼€å§‹ï¼‰ã€‚
- **ç”¨é€”**ï¼šè·å–å•é¡µçš„å›¾ç‰‡ URL å’Œå¯¹åº”çš„ OCR/æ ¡å¯¹æ–‡æœ¬ã€‚

### 3. ä½œå“ä¸»é¡µ (Work Page) - çº¯æ–‡æœ¬å±‚çº§
```
https://zh.wikisource.org/wiki/{Title}
```
- `{Title}`: ä½œå“åç§°ï¼Œå¦‚ `æ¤ç‰©åå¯¦åœ–è€ƒ`ã€‚
- **ç”¨é€”**ï¼šå±•ç¤ºæ•´ç†åçš„çº¯æ–‡æœ¬ç»“æ„ï¼Œé€šå¸¸å¼•ç”¨è‡ªå„ä¸ª `Page`ã€‚

## æœç´¢ API

ç»´åŸºæ–‡åº“æä¾›æ ‡å‡†çš„ **MediaWiki API**ã€‚

### æœç´¢ç´¢å¼•é¡µ (Index)
å¯»æ‰¾æ‰«æç‰ˆä¹¦ç±ï¼š
- **URL**: `https://zh.wikisource.org/w/api.php`
- **Method**: `GET`
- **Parameters**:
  - `action`: `query`
  - `list`: `search`
  - `srsearch`: `Index:{Keyword}` (å…³é”®è¯å‰åŠ  Index:)
  - `srnamespace`: `106` (106 æ˜¯ Index åå­—ç©ºé—´)
  - `format`: `json`

**ç¤ºä¾‹å“åº”**:
```json
{
    "query": {
        "search": [
            {
                "title": "Index:æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu",
                "pageid": 1062382,
                ...
            }
        ]
    }
}
```

## å…ƒæ•°æ®è·å–

### 2. é€šè¿‡ HTML è§£æ (Index é¡µé¢)
å…ƒæ•°æ®ä½äº `div.mw-parser-output` -> `table` (é€šå¸¸åŒ…å« `ws-index-metadata` class æˆ–ç±»ä¼¼çš„ç»“æ„)ã€‚
ç”±äºæ¨¡æ¿å¤šæ ·ï¼Œå»ºè®®ç›´æ¥æŸ¥æ‰¾ `th` (Label) å’Œ `td` (Value) çš„å¯¹åº”å…³ç³»ã€‚

**å­—æ®µæ˜ å°„ (å…¸å‹ Example)**:

| ä¸­æ–‡å­—æ®µ | æå–æ–¹å¼ |
|---------|---------|
| æ ‡é¢˜ | `th:contains("æ¨™é¡Œ") + td` |
| è‘—è€… | `th:contains("è‘—è€…") + td` |
| å‡ºç‰ˆå¹´ | `th:contains("å‡ºç‰ˆå¹´") + td` |
| æ¥æº | `th:contains("ä¾†æº") + td` |
| å›¾åƒ | `th:contains("åœ–åƒ") + td a` (æå– href) |

### 2. é€šè¿‡ API è§£æ (æ¨è)
ä½¿ç”¨ `action=parse` è·å–ç»“æ„åŒ– HTMLï¼Œæˆ–è€…è¯•å›¾è§£æ wikitextã€‚
```
https://zh.wikisource.org/w/api.php?action=parse&page=Index:æ¤ç‰©åå¯¦åœ–è€ƒ(ä¸€).djvu&format=json
```

## ä¸‹è½½

### 1. IIIF æ”¯æŒ (éå®˜æ–¹/ä»£ç†)
è™½ç„¶ MediaWiki æ ¸å¿ƒä¸ç›´æ¥æš´éœ² IIIF Manifestï¼Œä½†å¯ä»¥é€šè¿‡ Toolforge ä¸Šçš„ `zoomviewer` æˆ– `iipsrv` è®¿é—®ã€‚
- **Manifest URL** (ä¸ç¨³å®š): `https://tools.wmflabs.org/zoomviewer/proxy.php?iiif={Filename}/info.json`
- **æ³¨æ„**: éœ€è¦å¤„ç†é‡å®šå‘å’Œ CORSã€‚

### 2. ç›´æ¥è·å–å›¾ç‰‡ (MediaWiki API) - æ¨è
å¯¹äºæ¯ä¸€é¡µï¼Œå¯ä»¥é€šè¿‡ API è·å–é«˜æ¸…å›¾ã€‚

**æ­¥éª¤**:
1. è·å– `Index` é¡µé¢å†…å®¹ï¼Œè§£æå‡ºæ€»é¡µæ•°ï¼ˆé€šå¸¸åœ¨ HTML ä¸­æœ‰åˆ†é¡µé“¾æ¥åˆ—è¡¨ `class="prp-index-pagelist"`ï¼‰ã€‚
2. æ„é€ æ¯ä¸€é¡µçš„ Title: `Page:{Filename}/{PageNumber}`ã€‚
3. è°ƒç”¨ API è·å–å›¾ç‰‡ URL:
   ```
   https://zh.wikisource.org/w/api.php?action=query&titles=Page:{Filename}/{PageNumber}&prop=imageinfo&iiprop=url|size|mime&format=json
   ```
   **æ³¨æ„**: `Page` åå­—ç©ºé—´å¯¹åº”çš„æ˜¯é¡µé¢å¯¹è±¡ï¼Œå…¶å…³è”çš„å›¾ç‰‡é€šå¸¸éœ€è¦è§£æ HTML ä¸­çš„ `class="prp-page-image"` é‡Œçš„ `img src`ï¼Œæˆ–è€…æŸ¥è¯¢å…³è”çš„ `File:` å¯¹è±¡ã€‚
   
   **æ›´ç›´æ¥çš„æ–¹æ³•**: ç›´æ¥è¯·æ±‚ `File:{Filename}` çš„ç‰¹å®šé¡µç å›¾ç‰‡ï¼ˆå¦‚æœæ˜¯ DjVu/PDFï¼‰ã€‚
   ç›®å‰ Wiki ä¸»è¦æ˜¯é€šè¿‡ `thumb.php` æˆ– `Special:FilePath` æœåŠ¡å›¾ç‰‡ã€‚
   
   **å›¾ç‰‡ URL æ„é€ **:
   ```
   https://upload.wikimedia.org/wikipedia/commons/page{PageNumber}-{Width}px-{Filename}.jpg
   ```
   æˆ–è€…ä½¿ç”¨ `Special:FilePath`:
   ```
   https://zh.wikisource.org/w/index.php?title=Special:FilePath&file={Filename}&page={PageNumber}
   ```
   æ­¤ URL ä¼šé‡å®šå‘åˆ°å®é™…çš„å›¾ç‰‡åœ°å€ã€‚

### 3. ä¸‹è½½é™åˆ¶ä¸ Headers
- **User-Agent**: å¿…é¡»è®¾ç½® User-Agent (å¦‚ `Bot/1.0 (your@email.com)`), å¦åˆ™ä¼šè¢« MediaWiki API æ‹’ç» (HTTP 403)ã€‚
- **å¹¶å‘æ§åˆ¶**: éµå®ˆ API Etiquetteï¼Œä¸è¦é«˜å¹¶å‘è¯·æ±‚ã€‚
