# 关西大学图书馆

<!--
  本文件分两部分：
  - 分割线以上：用户文档，面向普通用户，语言简洁易懂，不含技术细节
  - 分割线以下：开发者文档，面向程序员，包含 API、HTML 解析、下载逻辑等技术细节
-->

关西大学数字档案（Kansai University Digital Archive）是由关西大学亚洲开放研究中心（KU-ORCAS）建设运营的开放资源平台，以 IIIF 标准公开关西大学总合图书馆及教员个人藏书中著作权已过保护期的东亚文化研究资料。书志信息采用 CC0 授权，资料图片标注为公有领域。

- 网站链接：https://www.iiif.ku-orcas.kansai-u.ac.jp/
- 分享协议：书志信息 [CC0](https://creativecommons.org/publicdomain/zero/1.0/)，资料图片 [Public Domain Mark 1.0](https://creativecommons.org/publicdomain/mark/1.0/)（可自由用于商业和非商业用途，无需授权，可复制、修改、出版）
- 约 2,200 部以上数字化资料（持续增加中）
- 资源类型：汉籍、和古书、大坂画坛绘画、篆刻印章、古文书/古记录、近代中国文学、亚洲电影相关资料
- 支持 IIIF 协议，可使用 [bookget](https://github.com/deweizhu/bookget) 等工具下载

## 搜索与浏览

- 搜索页面：https://www.iiif.ku-orcas.kansai-u.ac.jp/
- 支持按题名、著者、出版地、出版年、语言等字段搜索
- 提供高级搜索功能
- 支持统合检索和翻刻文检索（2022年3月新增）
- 使用国立情报学研究所的汉字字形索引
- 可按以下专题馆藏浏览：
  - 关西大学东亚数字档案
  - 大坂（阪）画坛数字档案
  - 泊园文库数字档案（儒学私塾泊园书院藏书）
  - 泊园印章数字档案
  - 增田文库
  - 长谷川贞信收藏（三代）
  - 近代中国文学数据库
  - 古文书/古记录数字档案
  - 亚洲电影相关资料档案
  - 高松塚古坟 VR
- 无需注册登录即可浏览和阅读

## 每本书能看到什么

| 字段 | 说明 | 示例 |
|------|------|------|
| 题名 | 书名 | 論語示蒙句解 10巻 |
| 著者 | 作者 | [仲欽著] |
| 出版地 | 刊行地 | 京都、大坂、江戸 |
| 分类号 | NDC分类 | 123.83 |
| 丛书 | 所属丛书 | 四書示蒙句解（全28巻） |
| 册数 | 物理册数 | 5冊 |

- 可通过 IIIF Curation Viewer 在线翻阅高清图片
- 可与其他 IIIF 兼容机构的资料并排比较阅读
- 支持添加注释和标签
- 资料为公有领域，可自由下载使用

## 示例

- 泊园文库详情页：https://www.iiif.ku-orcas.kansai-u.ac.jp/hakuen_bunko/002595672
- 东亚档案书籍详情页：https://www.iiif.ku-orcas.kansai-u.ac.jp/books/ma-z0706

---

# 开发者文档

## URL 结构

### 详情页
```
https://www.iiif.ku-orcas.kansai-u.ac.jp/{collection}/{item_id}
```
- `collection`：馆藏分类，如 `books`（东亚档案）、`hakuen_bunko`（泊园文库）等
- `item_id`：资料编号，如 `210185040`、`002595672`、`ma-z0706`

### IIIF Manifest
```
https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/{item_id}/manifest.json
```
- 示例：`https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/210185040/manifest.json`

### 图片服务
```
https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/2/{item_id}%2F{page_id}.tif/{region}/{size}/{rotation}/{quality}.{format}
```
- IIIF Image API 2.0 Level 1
- 图片原始格式为 TIFF，通过 IIIF 服务输出 JPEG
- 示例：`https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/2/210185040%2F001.tif/full/full/0/default.jpg`

### IIIF Curation Viewer
```
https://www.iiif.ku-orcas.kansai-u.ac.jp/libraries/iiif-curation-viewer/index.html?manifest=https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/{item_id}/manifest.json
```

## 搜索 API

无公开 REST API 文档。搜索通过网页表单提交，支持以下字段：
- 题名、著者、出版地、出版年、语言
- 统合检索、翻刻文检索

## 元数据获取

可从 IIIF Manifest JSON 中提取元数据。Manifest 遵循 IIIF Presentation API 2.0 规范。

### 字段映射（从 IIIF Manifest）

| 中文字段 | 提取方式 |
|---------|---------|
| 题名 | `manifest.label` |
| 著者 | `manifest.metadata[?label="著者"].value` |
| 出版地 | `manifest.metadata[?label="出版地"].value` |
| 分类号 | `manifest.metadata[?label="NDC"].value` |
| 丛书 | `manifest.metadata[?label="シリーズ"].value` |
| 授权 | `manifest.license`（Public Domain Mark 1.0） |
| 归属 | `manifest.attribution`（KU-ORCAS） |

## 下载

### IIIF 方式（推荐）

1. 获取 Manifest URL：`https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/{item_id}/manifest.json`
2. 解析 manifest 中的 `sequences[0].canvases`
3. 每个 canvas 的 `images[0].resource.service.@id` 为图片服务地址
4. 拼接 IIIF Image API 参数获取图片
   - 全尺寸：`/full/full/0/default.jpg`
   - 指定宽度：`/full/{width},/0/default.jpg`

IIIF Presentation API 版本：2.0
IIIF Image API 版本：2.0 Level 1
阅读方向：right-to-left
典型画幅：2000 x 1408 像素

### bookget 支持

bookget 的 IIIF wiki 页面列出了关西大学：
- Manifest 示例：`https://www.iiif.ku-orcas.kansai-u.ac.jp/iiif/books/210185040/manifest.json`
- 可直接使用 bookget 通用 IIIF 模块下载
- 源码参考：https://github.com/deweizhu/bookget/blob/main/app/iiif.go

### 注意事项

- 资料图片为公有领域，可自由使用
- 图片无水印
- 无需特殊 HTTP 请求头
- 无需认证（Cookie / Token / Referer）
