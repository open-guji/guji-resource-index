# 東北大學 - 狩野文庫

东北大学附属图书馆所藏的"狩野文库"，是明治时代文学博士狩野亨吉（1865-1942）旧藏的约 10.8 万册图书，经东北大学首任校长�的介绍入藏，涵盖哲学、艺术、军事学等广泛领域，被誉为"古典百科全书"和"江户学的宝库"。数字化图像通过"東北大学総合知デジタルアーカイブ"（TOUDA）平台公开。

- 网站链接：https://touda.tohoku.ac.jp/collection/database/library/collection/kano
- TOUDA 平台：https://touda.tohoku.ac.jp/
- 分享协议：CC BY 4.0（创作共用 署名 4.0 国际）
- 约 10.8 万册（其中约 4,000 种、40 万张图像已在线公开）
- 资源类型：和古书（日本古籍）、汉籍、绘画、地图、明信片、各学科古籍
- 支持 IIIF 协议，可使用 [bookget](https://github.com/deweizhu/bookget) 等工具下载
- 支持 Mirador 和 Universal Viewer 两种 IIIF 查看器
- 部分资料同时在国文学研究资料馆"新日本古典籍総合データベース"上公开
- 支持日文和英文界面

## 搜索与浏览

- 搜索页面：https://touda.tohoku.ac.jp/collection/database/library/collection/kano
- 英文界面：https://touda.tohoku.ac.jp/collection/en/database/library/collection/kano
- 支持按以下字段搜索：
  - 题名（Title）
  - 著者/作成者（Author/Creator）
  - 年代（Year）
  - 请求记号（Call Number）
  - レコードID（Record ID）
- 支持精确匹配搜索（用引号括起来）
- 可按资料类型筛选：刊本 / 写本、彩色 / 单色
- 可按分类浏览：
  - 哲学/宗教/教育
  - 历史/地理
  - 法律/经济
  - 语言/文学
  - 音乐/艺能
  - 艺术/工艺
  - 数学/自然科学
  - 医学
  - 工学/军事学
- 无需注册登录

## 每本书能看到什么

| 字段 | 说明 | 示例 |
|------|------|------|
| タイトル | 书名 | 世間娘氣質（新版繪入世間娘容氣） |
| 著者/作成者 | 作者 | 江島屋其磧 |
| 資料種別 | 资料类型 | 和古書 / 準貴重図書 |
| 旧蔵者 | 原藏书者 | 狩野亨吉 |
| 員数 | 册数 | 6册 |
| 言語 | 语言 | 日文 |
| 画像数 | 图像张数 | 127页 |
| 色彩 | 彩色/单色 | 白黒（单色） |
| 撮影年月日 | 拍摄日期 | 1991-1993 |
| コレクション | 所属文库 | 狩野文庫 |
| 請求記号 | 架位号 | 4/11724/6 |
| 所在 | 收藏地点 | 本館2号館 |
| ライセンス | 使用许可 | CC BY 4.0 |

- 提供 Mirador 和 Universal Viewer 两种 IIIF 查看器
- 支持在线翻阅全部页面
- 详情页含相关资料推荐（缩略图形式）
- 可链接至机构 OPAC 查看完整书目记录
- 无 PDF 下载
- 无全文文字（OCR）

## 示例

- 详情页：https://touda.tohoku.ac.jp/collection/database/library/public/10010000013241
- IIIF Manifest：https://touda.tohoku.ac.jp/collection/iiif/metadata/10010000013241/manifest.json

---

# 开发者文档

## URL 结构

### 详情页
```
https://touda.tohoku.ac.jp/collection/database/library/public/{record_id}
```
- `record_id`：资源标识符，如 `10010000013241`（长数字串）

### 狩野文库搜索/浏览页
```
https://touda.tohoku.ac.jp/collection/database/library/collection/kano
https://touda.tohoku.ac.jp/collection/en/database/library/collection/kano   # 英文版
```

搜索参数（附加在 URL 上）：
- `collection=19`：指定狩野文库
- `classification={number}`：分类编号

### IIIF Manifest
```
https://touda.tohoku.ac.jp/collection/iiif/metadata/{record_id}/manifest.json
```
- 例如：`https://touda.tohoku.ac.jp/collection/iiif/metadata/10010000013241/manifest.json`

### bookget IIIF wiki 中的旧格式
```
https://touda.tohoku.ac.jp/collection/iiif/0/metadata/{record_id}/manifest.json
```
- bookget wiki 中记录的格式含 `/0/`，实际两种格式可能均有效

## 搜索 API

搜索功能通过页面表单实现，结果在 HTML 中渲染。搜索参数包括：
- 题名、著者、年代、请求记号、Record ID
- 资料类型筛选：刊本/写本、彩色/单色
- 分类编号筛选

具体的后端 API 端点待进一步确认。网站集成了 Google Analytics（ID: G-4YWR8Y0RED）。

部分资料同时在国文学研究资料馆"新日本古典籍総合データベース"（https://kotenseki.nijl.ac.jp/）上公开，可通过该平台的 API 间接获取。

## 元数据获取

### 通过 HTML 解析

详情页为服务端渲染，元数据以结构化表格形式呈现（包含 Schema.org 标记）。

### 通过 IIIF Manifest

manifest 包含标准 IIIF 格式的元数据和图像信息。

### 字段映射

| 中文字段 | 提取方式 |
|---------|---------|
| タイトル | HTML 详情页 / IIIF Manifest `label` |
| 著者 | HTML 详情页解析 |
| 資料種別 | HTML 详情页解析 |
| コレクション | HTML 详情页解析 |
| 請求記号 | HTML 详情页解析 |
| ライセンス | HTML 详情页解析 |
| 图片列表 | IIIF Manifest `sequences[0].canvases[*]` |
| 图片服务 | IIIF Manifest `sequences[0].canvases[*].images[0].resource.service.@id` |

## 下载

### IIIF 下载（推荐）

TOUDA 平台完整支持 IIIF，且资源采用 CC BY 4.0 许可，这是获取图像的首选方式。

**从 Manifest 到图片 URL：**

1. 获取 manifest：`https://touda.tohoku.ac.jp/collection/iiif/metadata/{record_id}/manifest.json`
2. 解析 `sequences[0].canvases[]`
3. 提取每个 canvas 的 `images[0].resource.service.@id`
4. 拼接 IIIF Image API 参数：
   - 原始尺寸：`{service_id}/full/full/0/default.jpg`
   - 指定宽度：`{service_id}/full/{width},/0/default.jpg`
   - info.json：`{service_id}/info.json`

### bookget 支持

bookget IIIF wiki 页面已收录此站点（东北大学狩野文库）。可通过 IIIF 标准接口下载：

- 相关源码：https://github.com/deweizhu/bookget/blob/main/app/iiif.go
- bookget wiki：https://github.com/deweizhu/bookget/wiki/05.IIIF%E6%A0%87%E5%87%86%E7%BD%91%E7%AB%99URL
- 用法示例：
  ```
  bookget "https://touda.tohoku.ac.jp/collection/iiif/0/metadata/10010000027002/manifest.json"
  ```

**注意：** bookget 的 app 目录中没有专用的 tohoku.go 文件，通过通用的 iiif.go 处理 IIIF manifest。

### 图片保护

- 无水印
- CC BY 4.0 许可，可自由使用（需注明来源）
- 无 Token/Cookie 认证要求
- IIIF Image API 支持标准操作
