# 深圳市古籍数字图书馆

深圳图书馆建设的古籍数字化平台，提供馆藏古籍的在线阅览服务。

- 网站链接：https://yun.szlib.org.cn/stgj2021/
- 分享协议：待确认
- 约 300 种古籍、3,000 余册
- 资源类型：古籍善本
- 不支持 IIIF 协议
- 支持 [bookget](https://github.com/deweizhu/bookget) 下载

## 搜索与浏览

- 主页面：https://yun.szlib.org.cn/stgj2021/
- 具体搜索功能待确认（网站响应较慢）
- 无需注册登录（待确认）

## 每本书能看到什么

| 字段 | 说明 | 示例 |
|------|------|------|
| 题名 | 书名 | 待确认 |
| 著者 | 作者 | 待确认 |
| 卷册 | 分卷/分册信息 | 待确认 |

提供在线逐页浏览影像。

## 示例

- 主页面：https://yun.szlib.org.cn/stgj2021/

---

# 开发者文档

## URL 结构

### 书籍详情/阅读页
```
https://yun.szlib.org.cn/stgj2021/book_view/{book_id}
```

### 页面数据
```
https://yun.szlib.org.cn/stgj2021/book_page/{book_id}/{volume_id}/{page}
```

## 搜索 API

待确认。

## 元数据获取

待确认。网站响应较慢，可能需要从阅读页面的 API 响应中提取元数据。

## 下载

### bookget 支持

bookget 通过 `app/szlib.go` 支持此网站。

关键逻辑：
1. 从 URL 提取 `book_id`（正则：`book_id=([A-z\d]+)`）
2. 获取卷册列表：`/stgj2021/book_view/{bookId}`
3. 获取页面图片信息：`/stgj2021/book_page/{bookId}/{volumeId}/{page}`
4. 从首页响应中提取图片基础 URL，拼接后续页面的图片路径
5. 支持多线程并发下载，自动跳过已有文件

相关源码：
- https://github.com/deweizhu/bookget/blob/main/app/szlib.go
