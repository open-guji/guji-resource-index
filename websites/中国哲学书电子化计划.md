# 中国哲学书电子化计划

中国哲学书电子化计划（Chinese Text Project）是全球最大的中国先秦两汉古籍在线开放电子图书馆，由英国杜伦大学计算机科学系教师 Donald Sturgeon 创建并维护，专注于提供精确且便利使用的中国古代原典文献，尤其是先秦两汉时期文献。

- 网站链接：https://ctext.org/zh
- 分享协议：[版权所有 © 2006-2026](https://ctext.org/faq/zh#copyright)（需注明引用来源并附本站链接）
- 收录超过 30,000 部文献，超过 50 亿字
- 资源类型：古籍文本（含影印本对照）、英文翻译、注疏、讨论
- 不支持 IIIF 协议
- **注意**：网站明确禁止使用自动下载软件批量下载网页，违者将被自动封禁

## 搜索与浏览

- 搜索页面：https://ctext.org/zh
- 支持全文检索和书名检索，可在搜索框中输入关键词即可搜索 50 亿字的古籍文献
- 支持高级搜索，可按书名、作者、学派、时代等维度筛选
- 提供分类浏览：儒家、墨家、道家、法家、名家、兵家、算书、杂家、史书、经典文献、字书、医学等
- 涵盖时代：先秦两汉、魏晋、隋唐、宋、明、清、民国
- 基本功能无需注册，但建议注册免费账户以使用更多功能

## 每本书能看到什么

| 字段 | 说明 | 示例 |
|------|------|------|
| 书名 | 文献名称（中英文） | 論語 / Analects |
| 章节 | 各章节目录 | 學而、為政、八佾... |
| URN | 唯一资源标识符 | ctp:analects |
| 年代 | 创作/编纂时代 | 春秋戰國時期，公元前 480-350 年 |
| 底本 | 使用的版本 | 武英殿十三經注疏 |
| 全文 | 完整古文文本 | 繁体/简体版本 |
| 翻译 | 英文翻译 | 多数提供英译本 |
| 相关资源 | 学术出版物、讨论帖等 | 学术文章、讨论区帖子、数字图书馆资源 |

**补充说明**：
- 可在线逐段对照阅读中文原文和英译
- 部分文献提供影印本扫描图片，可点击段落左侧图标查看对应页面扫描
- 提供全文文字（非 OCR，来自已有电子文本或人工录入）
- 支持字典查询、全文搜索、相关段落查找等功能
- 有讨论区可与学者交流

## 两大内容体系

CText 有两个主要的内容体系：

### 1. 原典（Library）
- 经过编辑校对的经典文献（先秦两汉为主）
- 网址格式如 `ctext.org/analects/xue-er/zh`
- 提供中英对照、注疏等
- 无需登录即可阅读

### 2. 维基（Wiki）
- 用户贡献的文本资料，数量远多于原典
- 涵盖清代、宋明等更晚期文献
- 书级页面：`wiki.pl?if=gb&res={书ID}` — 显示作者、年代、版本等元数据及章节目录
- 章节页面：`wiki.pl?if=gb&chapter={章节ID}` — 显示正文内容
- 部分文本关联有影印本扫描底本

## 示例

**原典：**
- 儒家《论语》目录页：https://ctext.org/analects/zh
- 《论语·学而》章节阅读：https://ctext.org/analects/xue-er/zh

**维基：**
- 《四库全书简明目录》书级页面：https://ctext.org/wiki.pl?if=gb&res=1347940
- 《四库全书简明目录·卷一》章节页面：https://ctext.org/wiki.pl?if=gb&chapter=3658735

**图书馆影印本：**
- 图书馆影印本阅读示例：https://ctext.org/library.pl?if=zh&file=147636&page=1

---

# 开发者文档

## URL 结构

### 文献目录页
```
https://ctext.org/{book-slug}/{lang}
```
- `book-slug`：文献英文标识，如 `analects`（论语）、`mengzi`（孟子）、`dao-de-jing`（道德经）
- `lang`：语言版本
  - `zh`：繁体中文
  - `zhs`：简体中文
  - `en`：英文
  - `ens`：简体中文+英文

### 章节阅读页
```
https://ctext.org/{book-slug}/{chapter-slug}/{lang}
```
- `chapter-slug`：章节英文标识，如 `xue-er`（学而）

**URL 中可选参数**：
- `if=gb` 或 `if=en`：同 `lang` 参数，控制界面语言
- `remap=gb`：字体重映射参数

### 维基书级页（目录 + 元数据）
```
https://ctext.org/wiki.pl?if={lang}&res={res_id}
```
- `res_id`：书级资源 ID，如 `1347940`（四库全书简明目录）
- `if`：界面语言，`gb`=繁体中文，`en`=英文
- URN 格式：`ctp:wb{res_id}`（如 `ctp:wb1347940`）
- 页面包含：元数据表（作者、年代、版本、别名）+ 章节链接列表

### 维基章节页（正文内容）
```
https://ctext.org/wiki.pl?if={lang}&chapter={chapter_id}
```
- `chapter_id`：章节 ID，如 `3658735`（卷一）
- URN 格式：`ctp:ws{chapter_id}`（如 `ctp:ws3658735`）
- 页面正文在 `<td class="ctext">` 标签中

### 图书馆影印本阅读页
```
https://ctext.org/library.pl?if={lang}&file={file_id}&page={page_num}
```
或
```
https://library.ctext.org/{book-path}/{book-id}_{page_num:04d}.jpg
```
- `file_id`：文献文件 ID
- `page_num`：页码（从 1 开始）
- 图片直接存储在 `library.ctext.org` 域名下
- 图片 URL 示例：`https://library.ctext.org/h0063506/h0063506_0001.jpg`

### URN 标识符
ctext.org 使用 URN 体系标识每个资源，不同前缀表示不同类型：

| 前缀 | 类型 | 示例 | 说明 |
|------|------|------|------|
| `ctp:{slug}` | 原典文献 | `ctp:analects/xue-er` | 论语·学而 |
| `ctp:wb{id}` | 维基书级 | `ctp:wb1347940` | 四库全书简明目录 |
| `ctp:ws{id}` | 维基章节 | `ctp:ws3658735` | 四库全书简明目录·卷一 |

## 搜索 API

无独立的搜索 API 文档公开，但网站提供以下技术接口：

### 全文搜索
```
https://ctext.org/searchxml.pl?type=text&if={lang}&remap=
```
- 通过网页表单提交搜索请求

### OpenSearch 描述
- 原典搜索：`https://ctext.org/searchxml.pl?type=text&if=gb&remap=`
- 辞典搜索：`https://ctext.org/searchxml.pl?type=dic&if=gb&remap=`

## 元数据获取

### 页面 HTML 结构

ctext.org 是传统服务端渲染网站，元数据嵌入在 HTML 的 `<meta>` 标签中：

```html
<meta name="ctp-urn" content="ctp:analects/xue-er" />
<meta name="keywords" content="學而, 論語, 電子檔, 全文, 電子全文, 翻譯, 英文" />
<meta name="description" content="學而電子全文，全文檢索、相關於學而的討論及參考資料。有簡體字版、繁體字版、英文版本。"/>
<title>論語 : 學而 - 中國哲學書電子化計劃</title>
```

页面主体内容位于 `<div id="content">` 中，左侧目录在 `<div id="menu">` 中。

### API 接口（非官方公开文档）

ctext.org 提供 JSON API 用于获取文本内容：

**获取文本内容**：
```
GET https://api.ctext.org/gettext?urn={urn}&if={lang}
```

**请求示例**：
```bash
curl "https://api.ctext.org/gettext?urn=ctp:analects/xue-er&if=en"
```

**响应格式**（JSON）：
```json
{
  "title": "學而",
  "fulltext": [
    "子曰：「學而時習之，不亦說乎？有朋自遠方來，不亦樂乎？人不知而不慍，不亦君子乎？」",
    "有子曰：「其為人也孝弟，而好犯上者，鮮矣；不好犯上，而好作亂者，未之有也。君子務本，本立而道生。孝弟也者，其為仁之本與！」",
    ...
  ]
}
```

### API 对维基资源的支持

| URN 类型 | API 是否可用 | 说明 |
|----------|-------------|------|
| `ctp:{slug}` | ✓ 可用 | 原典文献，直接返回 fulltext |
| `ctp:ws{id}` | ✓ 可用 | 维基章节，返回 fulltext |
| `ctp:wb{id}` | ✗ 需认证 | 维基书级，返回 `ERR_REQUIRES_AUTHENTICATION` |

维基书级（`wb`）资源需要通过 HTML 解析获取元数据。

### 维基书级页元数据（HTML 解析）

维基书级页面包含结构化元数据表：

```html
<table class="restable">
  <tr><th class="colhead2">作者</th><td class="resrow">...</td></tr>
  <tr><th class="colhead2">成書年代</th><td class="resrow">清</td></tr>
  <tr><th class="colhead2">版本</th><td class="resrow">...</td></tr>
  <tr><th class="colhead2">其它名稱</th><td class="resrow">欽定四庫全書簡明目錄</td></tr>
</table>
```

提取方式：
```
CSS: th.colhead2 + td.resrow
正则: <th class="colhead2">(.*?)</th><td class="resrow"[^>]*>(.*?)</td>
```

章节链接列表通过 `(?:[?&]|&amp;)chapter=(\d+)` 提取（注意 HTML 中 `&` 编码为 `&amp;`）。

### 字段映射

从 HTML 提取元数据：

| 中文字段 | 提取方式 |
|---------|---------|
| URN 标识符 | `<meta name="ctp-urn" content="..." />` |
| 书名 | `<title>` 标签内容，格式：`{书名} : {章节} - 中國哲學書電子化計劃` |
| 章节名 | 从 `<title>` 或页面主标题提取 |
| 关键词 | `<meta name="keywords" content="..." />` |
| 简介 | `<meta name="description" content="..." />` |
| 全文内容 | API: `fulltext` 数组 |

从 API 提取（原典 + 维基章节）：

| 中文字段 | JSON 路径 |
|---------|---------|
| 章节标题 | `title` |
| 段落文本 | `fulltext[]`（数组） |

从维基书级 HTML 提取：

| 中文字段 | 提取方式 |
|---------|---------|
| 书名 | `<title>` 标签，去除 ` - 中國哲學書電子化計劃` 后缀 |
| URN | `<meta name="ctp-urn" content="ctp:wb{id}">` |
| 作者 | `th.colhead2` 文本为"作者"的对应 `td.resrow` |
| 年代 | `th.colhead2` 文本为"成書年代"的对应 `td.resrow` |
| 别名 | `th.colhead2` 文本为"其它名稱"的对应 `td.resrow` |
| 章节列表 | 正则 `(?:[?&]\|&amp;)chapter=(\d+)` 提取所有章节 ID |

## 下载

### IIIF 支持

**不支持** IIIF 协议。

### RDF / Linked Open Data

ctext.org 提供 RDF 数据下载（TTL 格式），包含历史人物、地点、著作、朝代、年号等实体及其关系：
- 下载页面：https://ctext.org/linked-open-data

RDF 使用命名空间：
- 实体：`https://data.ctext.org/entity/`
- 声明：`https://data.ctext.org/claim/`
- 属性：`https://data.ctext.org/property/`
- 限定符：`https://data.ctext.org/qualifier/`
- 类型：`https://data.ctext.org/type/`

可使用 Python `rdflib` 等工具解析 RDF 数据。

### 文本下载

**官方立场**：网站**严格禁止**使用自动下载软件批量下载大量网页，违者会被自动封禁 IP。

**合规方式**：
1. **手动浏览和复制**：适合少量引用
2. **使用 API 接口**：
   ```bash
   curl "https://api.ctext.org/gettext?urn=ctp:analects/xue-er&if=zh"
   ```
   - 一次请求一个章节的文本
   - 需控制请求频率，避免被封禁
3. **Python 库**：
   - `ctext` 包（PyPI）：https://pypi.org/project/ctext/
   - `ctextclassics`（GitHub）：https://github.com/Jjohn987/ctextclassics

### 影印图像下载

影印图像存储在 `library.ctext.org` 域名下，URL 结构：
```
https://library.ctext.org/{book_path}/{book_id}_{page_num:04d}.jpg
```

**示例**：
```
https://library.ctext.org/h0063506/h0063506_0001.jpg
https://library.ctext.org/h0063506/h0063506_0002.jpg
```

**获取方式**：
1. 访问 `library.pl` 页面查看页面 HTML
2. 在 HTML 中查找 `<img>` 标签，提取 `src` 属性中的图片 URL
3. 图片 URL 通常包含在以下位置：
   ```html
   <img ... src='https://library.ctext.org/{path}/{filename}.jpg' ... />
   ```

**注意事项**：
- 图片下载同样需遵守网站使用条款，不可批量自动下载
- 需在 HTTP 请求中包含合适的 `Referer` 和 `User-Agent` 头
- 建议控制下载频率以避免被封禁

### bookget 支持

bookget **不支持** ctext.org（截至 v25.0701）。

### 引用规范

根据网站要求，引用 ctext.org 内容时：
1. 必须注明引用来源
2. 必须同时加上至本站的链接：http://ctext.org/zh
3. 建议使用 URN 标识符（如 `ctp:analects/xue-er`）或完整 URL

示例：
> 資料來源：中國哲學書電子化計劃，https://ctext.org/analects/xue-er/zh (URN: ctp:analects/xue-er)

## 技术特点

- **多语言支持**：繁体中文、简体中文、英文
- **多版本对照**：部分文献提供多个版本的底本
- **影印对照**：可查看原书扫描图像
- **全文搜索**：50 亿字级别的全文检索
- **讨论社区**：学者可针对具体段落进行讨论
- **API 访问**：提供 JSON API（虽未正式公开文档）
- **RDF 数据**：提供 Linked Open Data 导出
- **DNS 预取**：网站使用 `api.ctext.org`、`library.ctext.org`、`dimage.ctext.org` 等子域名

## 参考资料

- 官方入门教程（中文）：https://dsturgeon.net/ctext-zhs/
- 官方入门教程（英文）：https://dsturgeon.net/ctext/
- 学术论文：[Chinese Text Project: A dynamic digital library of premodern Chinese](https://academic.oup.com/dsh/article/36/Supplement_1/i101/5556365)
- RDF 使用教程：[Using ctext.org RDF in Python](https://digitalsinology.org/using-ctext-org-rdf-in-python/)
- 文本工具：https://dsturgeon.net/texttools/
